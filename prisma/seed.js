const { PrismaClient } = require("@prisma/client");
const { hash } = require("bcryptjs");

const prisma = new PrismaClient();

async function main() {
  console.log("Starting database seed...");

  // إنشاء مستخدم للتجربة إذا لم يكن موجودًا
  const adminEmail = "admin@example.com";
  const adminExists = await prisma.user.findUnique({
    where: { email: adminEmail },
  });

  const adminUser =
    adminExists ||
    (await prisma.user.create({
      data: {
        email: adminEmail,
        name: "المشرف",
        password: await hash("Admin123!", 12),
        role: "ADMIN",
        emailVerified: true,
      },
    }));

  // إنشاء مستخدم عادي للتجربة إذا لم يكن موجودًا
  const studentEmail = "student@example.com";
  const studentExists = await prisma.user.findUnique({
    where: { email: studentEmail },
  });

  const studentUser =
    studentExists ||
    (await prisma.user.create({
      data: {
        email: studentEmail,
        name: "أحمد الطالب",
        password: await hash("Student123!", 12),
        role: "STUDENT",
        emailVerified: true,
      },
    }));

  // التحقق من وجود قصص نجاح
  const storiesCount = await prisma.successStory.count();

  if (storiesCount === 0) {
    console.log("Adding success stories...");

    // إضافة قصص نجاح متنوعة
    await prisma.successStory.createMany({
      data: [
        {
          userId: adminUser.id,
          name: "سارة أحمد",
          profession: "مصممة أزياء",
          story:
            "بدأت رحلتي في تعلم التطريز والخياطة من الصفر تمامًا عندما التحقت بالدورة الأساسية. كنت أشعر بالتردد في البداية، لكن بفضل الدعم المستمر من المدربين والمجتمع الرائع، تمكنت من تطوير مهاراتي بسرعة كبيرة. اليوم، أصبحت أملك متجري الخاص للأزياء المطرزة يدويًا، وأتلقى طلبات من جميع أنحاء البلاد. الدورة غيرت حياتي المهنية بالكامل وفتحت لي آفاقًا جديدة للإبداع والاستقلال المالي.",
          achievement: "إنشاء مشروع خاص",
          course: "التطريز المتقدم",
          imageUrl:
            "https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg",
          status: "APPROVED",
          isFeature: true,
        },
        {
          userId: studentUser.id,
          name: "محمد علي",
          profession: "صانع حرفي",
          story:
            "انضممت إلى دورة صناعة الإكسسوارات اليدوية بعد فترة طويلة من البطالة. كنت أبحث عن مهارة جديدة يمكن أن تساعدني في كسب دخل إضافي. خلال الدورة، اكتشفت شغفي بالعمل بالخرز والأحجار، وتعلمت تقنيات متنوعة لصناعة المجوهرات. بعد ثلاثة أشهر فقط من إكمال الدورة، بدأت في بيع منتجاتي عبر الإنترنت، وأصبحت الآن أحقق دخلاً شهرياً ثابتاً يفوق توقعاتي. أنا ممتن جداً للفرصة التي قدمتها لي هذه الدورة لتغيير مسار حياتي المهنية.",
          achievement: "بيع المنتجات عبر الإنترنت",
          course: "صناعة الإكسسوارات",
          imageUrl:
            "https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg",
          status: "APPROVED",
          isFeature: true,
        },
        {
          userId: adminUser.id,
          name: "نورا محمود",
          profession: "مدرسة حرف يدوية",
          story:
            "كنت أعمل كمعلمة في مدرسة ابتدائية، لكنني كنت دائمًا أحب الحرف اليدوية وأمارسها كهواية. قررت الالتحاق بدورة النسيج اليدوي لتطوير مهاراتي، ولم أكن أتوقع أن تتغير حياتي بهذا الشكل! بعد إتمام الدورة، بدأت في تقديم ورش عمل صغيرة للأطفال في مدرستي، ثم توسعت لتشمل مراكز ثقافية في المدينة. اليوم، تركت وظيفتي كمعلمة وأصبحت مدربة متفرغة للحرف اليدوية، وأسست مركزًا صغيرًا لتعليم النساء المهارات الحرفية التي يمكن أن تساعدهن في تحقيق الاستقلال المالي.",
          achievement: "تأسيس مركز تدريب",
          course: "النسيج اليدوي",
          imageUrl:
            "https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg",
          status: "APPROVED",
          isFeature: true,
        },
        {
          userId: studentUser.id,
          name: "أحمد سمير",
          profession: "صاحب متجر إلكتروني",
          story:
            "كنت أعاني من صعوبات مالية كبيرة بعد فقدان وظيفتي. التحقت بدورة الحرف اليدوية الأساسية بهدف شغل وقت فراغي وتخفيف التوتر، لكنني اكتشفت موهبة لم أكن أعلم بوجودها في صناعة المنتجات الجلدية. أثناء الدورة، تعلمت أساسيات العمل بالجلد وصنعت أول محفظة ومفكرة. شجعني المدربون على مواصلة التطور والإنتاج، وبعد ستة أشهر، أنشأت متجرًا إلكترونيًا لبيع منتجاتي الجلدية. الآن أصبح لدي زبائن من داخل البلد وخارجها، وتحسنت حالتي المالية بشكل لم أكن أتخيله.",
          achievement: "تحقيق مبيعات دولية",
          course: "صناعة المنتجات الجلدية",
          imageUrl:
            "https://images.pexels.com/photos/91227/pexels-photo-91227.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: adminUser.id,
          name: "ليلى عبد الرحمن",
          profession: "فنانة تشكيلية",
          story:
            "التحقت بدورة الرسم والتلوين على القماش لإضافة تقنية جديدة إلى مهاراتي كفنانة. لم أتوقع أن تفتح لي هذه الدورة مجالًا جديدًا تمامًا! تعلمت تقنيات متنوعة لتلوين الأقمشة وتصميم الأنماط، وبدأت في دمج هذه التقنيات مع لوحاتي التقليدية. نتج عن ذلك أسلوب فني فريد جذب انتباه المعارض المحلية. تمكنت من عرض أعمالي في ثلاثة معارض مرموقة خلال العام الماضي، وتلقيت طلبات خاصة لتصميم قطع فنية لمؤسسات عامة وخاصة. هذه الدورة فتحت لي آفاقًا جديدة للتعبير الفني والنجاح المهني.",
          achievement: "عرض الأعمال في معارض فنية",
          course: "الرسم على القماش",
          imageUrl:
            "https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: studentUser.id,
          name: "عمر حسن",
          profession: "مصمم أثاث",
          story:
            "كنت أعمل في مجال النجارة التقليدية لسنوات، لكنني شعرت أن مهاراتي تحتاج إلى تطوير. التحقت بدورة تصميم وصناعة الأثاث المعاصر لتعلم تقنيات جديدة ودمج الحرف التقليدية مع التصاميم الحديثة. كانت هذه نقطة تحول في مسيرتي المهنية! تعلمت استخدام برامج التصميم ثلاثية الأبعاد، وتقنيات معالجة الخشب المبتكرة، وأساليب دمج المواد المختلفة. بعد الدورة، قمت بتجديد ورشتي وبدأت في إنتاج قطع أثاث تجمع بين الأصالة والحداثة. أصبحت منتجاتي الآن مطلوبة من قبل مصممي الديكور الداخلي والمنازل الراقية، وتضاعف دخلي ثلاث مرات.",
          achievement: "تطوير خط إنتاج مبتكر",
          course: "تصميم الأثاث المعاصر",
          imageUrl:
            "https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg",
          status: "PENDING",
          isFeature: false,
        },
        // إضافة قصص جديدة للتصفح الصفحي
        {
          userId: adminUser.id,
          name: "سمية الجابري",
          profession: "مصممة مجوهرات",
          story:
            "بعد سنوات من العمل في وظيفة إدارية، قررت الاستماع إلى شغفي بالفنون اليدوية. التحقت بدورة تصميم المجوهرات وتعلمت كيفية استخدام مواد متنوعة وتقنيات مختلفة. في غضون عام واحد، طورت مجموعتي الخاصة من المجوهرات المستوحاة من التراث العربي، وبدأت بعرضها في المعارض المحلية. الإقبال على منتجاتي فاق كل توقعاتي! اليوم، لدي استوديو خاص وأعمل بدوام كامل في تصميم وبيع المجوهرات. تغيرت حياتي تماماً بفضل هذه الدورة التي ساعدتني على اكتشاف موهبتي واستثمارها.",
          achievement: "إنشاء علامة تجارية للمجوهرات",
          course: "تصميم المجوهرات اليدوية",
          imageUrl:
            "https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: studentUser.id,
          name: "كريم الشهابي",
          profession: "حرفي خشب",
          story:
            "كنت أعمل في مجال المبيعات لمدة عشر سنوات، ولكن كان لدي دائمًا شغف بالأعمال الخشبية. بعد فقدان وظيفتي خلال جائحة كورونا، قررت استثمار وقتي في تعلم حرفة جديدة. التحقت بدورة النحت على الخشب، وكانت نقطة تحول في حياتي! تعلمت تقنيات متنوعة وبدأت في إنتاج قطع فنية خشبية صغيرة. شاركت في معرض محلي وفوجئت بالإقبال الكبير على منتجاتي. اليوم، لدي ورشة صغيرة في منزلي وأتلقى طلبات مخصصة من عملاء من داخل وخارج البلد. أشعر بالامتنان العميق لهذه الدورة التي منحتني مهارة أحبها وأكسب منها دخلاً جيدًا.",
          achievement: "التحول المهني الناجح",
          course: "النحت على الخشب",
          imageUrl:
            "https://images.pexels.com/photos/1516680/pexels-photo-1516680.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: adminUser.id,
          name: "هدى الحكيم",
          profession: "مصممة أزياء تقليدية",
          story:
            "كنت أعمل كمعلمة للفنون في مدرسة ثانوية، وكان لدي اهتمام بالأزياء التقليدية والتراثية. التحقت بدورة تصميم الأزياء التراثية لتنمية مهاراتي، وكانت تجربة رائعة! تعلمت تقنيات متخصصة لإعادة إحياء التصاميم التراثية بلمسات عصرية. بعد الدورة، صممت مجموعة صغيرة من الأزياء التراثية المعاصرة، وعرضتها في معرض محلي. حظيت بإعجاب كبير ودعم من المهتمين بالتراث، مما شجعني على إنشاء علامتي التجارية الخاصة. اليوم، أعمل بدوام جزئي في التدريس وبدوام جزئي في تصميم الأزياء التراثية، وأصبحت علامتي معروفة محليًا وإقليميًا.",
          achievement: "إحياء التراث من خلال الموضة",
          course: "تصميم الأزياء التراثية",
          imageUrl:
            "https://images.pexels.com/photos/1036623/pexels-photo-1036623.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: studentUser.id,
          name: "محمود العربي",
          profession: "صانع فخار",
          story:
            "نشأت في عائلة تعمل في صناعة الفخار التقليدي، لكنني لم أتعلم الحرفة في صغري. عندما توفي والدي، شعرت بالحزن لأن تراث العائلة قد ينتهي معه. التحقت بدورة صناعة الفخار لإحياء تراث عائلتي، وكانت تجربة مؤثرة! تعلمت التقنيات الأساسية وتعرفت على أساليب حديثة في التصميم والزخرفة. بعد الانتهاء من الدورة، أعدت افتتاح ورشة والدي وبدأت في إنتاج قطع فخارية تجمع بين الأصالة والحداثة. اليوم، أعمل على توثيق وإحياء تقنيات الفخار التقليدية في منطقتنا، وأقدم ورش عمل للأطفال والشباب لنقل هذا التراث للأجيال القادمة.",
          achievement: "إحياء تراث عائلي",
          course: "صناعة الفخار التقليدي",
          imageUrl:
            "https://images.pexels.com/photos/1681010/pexels-photo-1681010.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: adminUser.id,
          name: "رنا الزهراني",
          profession: "مصممة حقائب",
          story:
            "كنت أعمل في مجال التسويق، لكنني كنت دائمًا مهتمة بالموضة والإكسسوارات. قررت الالتحاق بدورة تصميم الحقائب الجلدية خلال إجازتي السنوية، وكانت تجربة غيرت مسار حياتي المهنية! تعلمت تقنيات معالجة الجلود وتصميم النماذج وتنفيذها بشكل احترافي. بعد الانتهاء من الدورة، بدأت في إنتاج حقائب مميزة في وقت فراغي. مع مرور الوقت، زاد الطلب على منتجاتي مما شجعني على ترك وظيفتي والتفرغ لمشروعي الخاص. اليوم، لدي علامة تجارية ناجحة للحقائب اليدوية، وأبيع منتجاتي محليًا وعبر الإنترنت لعملاء من دول مختلفة.",
          achievement: "تأسيس علامة تجارية للحقائب",
          course: "تصميم الحقائب الجلدية",
          imageUrl:
            "https://images.pexels.com/photos/1587009/pexels-photo-1587009.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
        {
          userId: studentUser.id,
          name: "علي الدوسري",
          profession: "فنان خط عربي",
          story:
            "كنت أعمل في مجال المحاسبة، لكنني كنت دائمًا مفتونًا بجمال الخط العربي. التحقت بدورة الخط العربي كهواية في البداية، لكنني وجدت فيها شغفًا عميقًا. تعلمت أنماط الخط العربي المختلفة وتقنيات الكتابة التقليدية والمعاصرة. مع تحسن مهاراتي، بدأت في تلقي طلبات لإنشاء لوحات وتصاميم خطية مخصصة. بعد سنتين من الممارسة المستمرة، قررت تقليل ساعات عملي في المحاسبة والتركيز أكثر على فن الخط. اليوم، أنا أستاذ للخط العربي، وأقدم دورات تدريبية، وأشارك في معارض فنية محلية ودولية. هذه الدورة غيرت حياتي وفتحت لي أبوابًا لم أكن أتخيلها.",
          achievement: "تحول الهواية إلى مهنة",
          course: "فن الخط العربي",
          imageUrl:
            "https://images.pexels.com/photos/1270076/pexels-photo-1270076.jpeg",
          status: "APPROVED",
          isFeature: false,
        },
      ],
    });

    console.log("Success stories added successfully!");
  } else {
    console.log(
      `Found ${storiesCount} existing success stories, skipping seed.`
    );
  }

  console.log("Database seed completed successfully!");
}

main()
  .catch((e) => {
    console.error("Error during database seed:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
